---
- hosts: peppol
  roles:
    - load-tests
  vars:
    file: /peppol/data/storage/performance-tests/average-file/average-file-165KB.xml
    etalon: 1
    module: Validator
    msg_count: 98
    msg_type: average
    wait_time: "{{ (etalon + 1200)|int }}"
    middle_filename: /peppol/data/storage/performance-tests/average-file/average-file-165KB.xml
    load_tests_first_rabbit: '{"version":1.1,"processingInfo":{"source":{"name":"transport-from-a2a","type":"OUT_FILE_TO_MQ"},"sourceMetadata":"Received by transport-from-a2a as /peppol-a2a-nfs/out/test/data/average-file-165KB.xml","route":{"endpoints":["validator","outbound","outbound:exchange=peppol-delayed,x-delay=30000","outbound:exchange=peppol-delayed,x-delay=30000"],"description":"A2A to Peppol","source":"transport-from-a2a","current":1},"currentEndpoint":{"name":"internal-routing","type":"OUT_ROUTING"},"currentStatus":"route set","attemptId":0,"eventingMessage":{"id":"OUT_average-file-165KB_transport-from-a2a","created":1518104314010,"isInbound":false,"attempts":[{"id":"1518104314010_average-file-165KB.xml","events":[{"id":1518104314010,"source":"transport-from-a2a","status":"received","terminal":false,"details":"Picked up file by transport"},{"id":1518104317466,"source":"preprocessing","status":"parsed","terminal":false,"details":"Preprocessing complete, sent to  internal-routing"},{"id":1518104317566,"source":"internal-routing","status":"route set","terminal":false,"details":"Route set, sent to  validator"}],"filename":"/peppol/data/storage/9908_987987987/9908_987987987/20180208/average-file-165KB.xml"}],"documentType":"Invoice","documentNumber":"0518003559","documentDate":"2016-12-01","dueDate":"2016-12-31"}},"fileName":"{{ first_filename }}","originalFileName":"average-file-165KB","documentInfo":{"errors":[],"warnings":[],"senderId":"9908:987987987","recipientId":"9908:987987987","versionId":"2.1","documentId":"0518003559","issueDate":"2016-12-01","issueTime":"","dueDate":"2016-12-31","senderName":"OpusCapita test","senderCountryCode":"SE","recipientName":"OpusCapita test","recipientCountryCode":"SE","profileId":"urn:www.cenbii.eu:profile:bii04:ver2.0","customizationId":"urn:www.cenbii.eu:transaction:biitrns010:ver2.0:extended:urn:www.peppol.eu:bis:peppol4a:ver2.0","rootNameSpace":"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2","rootNodeName":"Invoice","archetype":"PEPPOL_BIS","documentType":"Invoice","documentBusinessIdentifier":"457695c6-1_1C2ADA35"}}'
    load_tests_middle_rabbit: '{"version":1.1,"processingInfo":{"source":{"name":"transport-from-a2a","type":"OUT_FILE_TO_MQ"},"sourceMetadata":"Received by transport-from-a2a as /peppol-a2a-nfs/out/test/data/average-file-165KB.xml","route":{"endpoints":["validator","outbound","outbound:exchange=peppol-delayed,x-delay=30000","outbound:exchange=peppol-delayed,x-delay=30000"],"description":"A2A to Peppol","source":"transport-from-a2a","current":1},"currentEndpoint":{"name":"internal-routing","type":"OUT_ROUTING"},"currentStatus":"route set","attemptId":0,"eventingMessage":{"id":"OUT_average-file-165KB_transport-from-a2a","created":1518104314010,"isInbound":false,"attempts":[{"id":"1518104314010_average-file-165KB.xml","events":[{"id":1518104314010,"source":"transport-from-a2a","status":"received","terminal":false,"details":"Picked up file by transport"},{"id":1518104317466,"source":"preprocessing","status":"parsed","terminal":false,"details":"Preprocessing complete, sent to  internal-routing"},{"id":1518104317566,"source":"internal-routing","status":"route set","terminal":false,"details":"Route set, sent to  validator"}],"filename":"/peppol/data/storage/9908_987987987/9908_987987987/20180208/average-file-165KB.xml"}],"documentType":"Invoice","documentNumber":"0518003559","documentDate":"2016-12-01","dueDate":"2016-12-31"}},"fileName":"{{ middle_filename }}","originalFileName":"average-file-165KB","documentInfo":{"errors":[],"warnings":[],"senderId":"9908:987987987","recipientId":"9908:987987987","versionId":"2.1","documentId":"0518003559","issueDate":"2016-12-01","issueTime":"","dueDate":"2016-12-31","senderName":"OpusCapita test","senderCountryCode":"SE","recipientName":"OpusCapita test","recipientCountryCode":"SE","profileId":"urn:www.cenbii.eu:profile:bii04:ver2.0","customizationId":"urn:www.cenbii.eu:transaction:biitrns010:ver2.0:extended:urn:www.peppol.eu:bis:peppol4a:ver2.0","rootNameSpace":"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2","rootNodeName":"Invoice","archetype":"PEPPOL_BIS","documentType":"Invoice","documentBusinessIdentifier":"457695c6-1_1C2ADA35"}}'
    load_tests_last_rabbit: '{"version":1.1,"processingInfo":{"source":{"name":"transport-from-a2a","type":"OUT_FILE_TO_MQ"},"sourceMetadata":"Received by transport-from-a2a as /peppol-a2a-nfs/out/test/data/average-file-165KB.xml","route":{"endpoints":["validator","outbound","outbound:exchange=peppol-delayed,x-delay=30000","outbound:exchange=peppol-delayed,x-delay=30000"],"description":"A2A to Peppol","source":"transport-from-a2a","current":1},"currentEndpoint":{"name":"internal-routing","type":"OUT_ROUTING"},"currentStatus":"route set","attemptId":0,"eventingMessage":{"id":"OUT_average-file-165KB_transport-from-a2a","created":1518104314010,"isInbound":false,"attempts":[{"id":"1518104314010_average-file-165KB.xml","events":[{"id":1518104314010,"source":"transport-from-a2a","status":"received","terminal":false,"details":"Picked up file by transport"},{"id":1518104317466,"source":"preprocessing","status":"parsed","terminal":false,"details":"Preprocessing complete, sent to  internal-routing"},{"id":1518104317566,"source":"internal-routing","status":"route set","terminal":false,"details":"Route set, sent to  validator"}],"filename":"/peppol/data/storage/9908_987987987/9908_987987987/20180208/average-file-165KB.xml"}],"documentType":"Invoice","documentNumber":"0518003559","documentDate":"2016-12-01","dueDate":"2016-12-31"}},"fileName":"{{ last_filename }}","originalFileName":"average-file-165KB","documentInfo":{"errors":[],"warnings":[],"senderId":"9908:987987987","recipientId":"9908:987987987","versionId":"2.1","documentId":"0518003559","issueDate":"2016-12-01","issueTime":"","dueDate":"2016-12-31","senderName":"OpusCapita test","senderCountryCode":"SE","recipientName":"OpusCapita test","recipientCountryCode":"SE","profileId":"urn:www.cenbii.eu:profile:bii04:ver2.0","customizationId":"urn:www.cenbii.eu:transaction:biitrns010:ver2.0:extended:urn:www.peppol.eu:bis:peppol4a:ver2.0","rootNameSpace":"urn:oasis:names:specification:ubl:schema:xsd:Invoice-2","rootNodeName":"Invoice","archetype":"PEPPOL_BIS","documentType":"Invoice","documentBusinessIdentifier":"457695c6-1_1C2ADA35"}}'
...
